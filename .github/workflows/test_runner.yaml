name: Tests

on: [push]

jobs:
  test_job:
    runs-on: ubuntu-latest
    name: Test notebooks are runnable and up-to-date
    steps:

    - name: Checkout
      uses: actions/checkout@v1

    - name: Build and start containers
      run: docker-compose up -d

    - name: Wait for SQL Server container to finish initialising
      run: sleep 20

    - name: Test Stata model
      run: docker-compose run app python3 run_model.py test

    - name: Run tests
      run: ./run_tests.sh
