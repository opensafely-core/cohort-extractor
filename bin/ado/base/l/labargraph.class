*! version 1.0.1  01apr2005
version 8

class {
	labelstyle = .labarstyle.new

} , inherit(bargraph)

program new

	.labelstyle.ref = .labarstyle.new
	.Super.new `0'
end


program draw_bar

	args x0 y0 height id

	.Super.draw_bar `0'

	local gtrans = `gdi(gbeta)' / `gdi(ybeta)'
			/* ?? should have moveto that take gbeta values */

	local x = `x0' + `.barsize' / 2 + `.labelstyle.xoffset.val' * `gtrans'

	local y = `y0' + `height' + `.labelstyle.yoffset.val' * `gtrans'
	if "`.labelstyle.position.stylename'" == "above" {
		local y = `y' + (`.labelstyle.textstyle.size.val')*`gtrans'
	}
	else	local y = `y' - 1*`gtrans'

	tempname text
	local lab = string(`height', "`.labelstyle.format'")
	.`text' = .text.new , text(`lab') x(`x') y(`y')			/*
		*/ style(`.labelstyle.textstyle.stylename')
	.`text'.draw
	
end
